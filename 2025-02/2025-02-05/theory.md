# :books: 이론 보충

## 1. 데이터 링크의 제어 방식

### 회선 제어

데이터 링크는 다음에 따라 구분된다.

- 데이터의 흐름과 타이밍
    - 단방향: 데이터 흐름이 한 방향으로만 허용되는 경우
    - 양방향: 상호 전송 및 수신이 가능한 경우
        - 반이중 전송 링크: 상호 동시 전송이 허용되지 않음
        - 전이중 전송 링크: 동시 전송이 허용됨

만일 반이중 전송 링크에서 두 개의 스테이션이 동시에 신호를 전송한다면 데이터 충돌은 피할 수 없다. 따라서 회선의 규칙이 필요하다. 이 규칙을 회선제어라고 하고 대표적으로 ENQ/ACK 방식, 폴링 방식, 경쟁 방식, 예약 방식 등이 있는데, 강의자료에는 ENQ/ACK 방식을 설명하니 그것을 설명하겠다.

#### ENQ/ACK 방식

![출처: https://physicallaw.tistory.com/81](/images/2025-02/2025-02-05/01-01.png)

출처: https://physicallaw.tistory.com/81

ENQ/ACK 방식은 전용 전송링크로 구성된 두 스테이션 사이에 주로 사용된다. 두 스테이션 어느 쪽에서든 전송을 시작할 수 있다.

위의 예는 스테이션 A가 ENQ 프레임을 보내 연결이 초기화 과정이 진행되면 스테이션 B는 ENQ 프레임에 대한 응답으로 ACK 프레임을 보내 데이터를 받을 준비가 되었음을 알린다. 스테이션 A는 이제 데이터 프레임을 전송하고, 스테이션 B는 이에 대한 ACK 프레임을 보내는 과정이 계속된다. 마지막으로 전송의 끝을 알리는 EOT 프레임을 보냄으로써 작업이 종료된다.

### 오류 제어

송수신 데이터가 외부 간섭, 시간 지연 등에 의해 데이터가 변형되거나 순서가 어긋나는 등의 통신 장애가 발생하지 않도록 오류를 검출하고 정정하여 통신에 대한 신뢰성을 확보하는 제어다.

오류가 발생하는 장소나 원인에 따라 적절한 오류 제어방식을 사용하여 오류를 검출하고 수정 및 처리한다. 오류제어 방식의 종류는 다음과 같다.

![출처: https://insightlog.tistory.com/118](/images/2025-02/2025-02-05/01-02.png)

출처: https://insightlog.tistory.com/118

#### 패리티 검사

이 중 ARQ의 방식 중 하나인 패리티 검사에 대해 설명해주셨다.

패리티 검사는 수신자에게 보내는 최종 데이터의 1의 개수를 짝수 개로 보낼지, 홀수 개로 보낼지 송수신자가 미리 약속하고 여분의 비트(패리티 비트)를 채워 보내는 방법이다.

**짝수 패리티**

| 원본 데이터 7비트 | 짝수 패리티 | 패리티비트 포함 8비트 |
| --- | --- | --- |
| 1001001 | 1 | 10010011 |
| 1010011 | 0 | 10100110 |
| 1111111 | 1 | 11111111 |
| 1000000 | 1 | 10000001 |

**홀수 패리티**

| 원본 데이터 7비트 | 짝수 패리티 | 패리티비트 포함 8비트 |
| --- | --- | --- |
| 1001001 | 0 | 10010010 |
| 1010011 | 1 | 10100111 |
| 1111111 | 0 | 11111110 |
| 1000000 | 0 | 10000000 |

이러한 패리티비트는 데이터의 오류를 검출해낼 수는 있지만 정정할 수 있는 능력이 없다는 단점이 있다. 또한, 두 비트 이상 오류 발생 시 오류를 검출할 수 없을 수도 있는 단점이 있다.

### 흐름 제어

송신자와 수신자의 데이터 처리 속도 차이를 해결하기 위해 수신자 상황에 따라 송신자의 데이터 전송량을 조정하는 제어를 뜻한다. 흐름제어로 사용되는 방법 중 하나는 Stop and Wait 기법이다.

#### Stop $ Wait

송신자가 하나의 데이터를 전송한 후 다음 데이터를 전달하기 전에 확인 응답을 기다리는 방법이다. 수신자가 ACK라는 메시지를 송신자에게 전달해야만 다음 데이터를 보낸다.

![image.png](/images/2025-02/2025-02-05/01-03.png)

## 2. 스위치에서 MAC 테이블 관리하기

스위치는 허브와 같이 컴퓨터나 프린터 등을 연결하여 데이터를 공유하는 것 외에 또 다른 기능이 있는데 바로 스위치 포트에 연결된 컴퓨터의 MAC 주소를 관리하는 기능이다.

예를 들어, 다음 그림과 같이 “1번 포트의 MAC 주소는 무엇이다”라는 형태의 테이블로 관리하는데, 이것을 MAC 테이블이라고 한다.

![image.png](/images/2025-02/2025-02-05/02-01.png)

또한, 스위치는 다음 예와 같이, 컴퓨터 A가 같은 스위치로 연결되어 있는 컴퓨터 B랑 통신을 요청할 때, 스위치는 먼저 MAC 테이블을 확인해보고, 컴퓨터 B의 MAC 주소가 없으면 브로드캐스트를 통해 MAC 테이블을 갱신한 뒤에 컴퓨터 A에게 MAC 주소를 알려준다.

![image.png](/images/2025-02/2025-02-05/02-02.png)

## 3. NAT (Network Address Translation)

NAT는 네트워크 주소 변환이라하고 IP패킷의 TCP/UDP 포트 숫자와 소스 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술을 말한다.

→ 즉, IP를 변환하겠다는 뜻

NAT를 이용하는 이유는 대개 사설 네트워크에 속한 여러 개의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하기 위함이다.

IP 주소에는 공인 IP와 사설 IP가 있다. 그런데 공인 IP 주소는 전세계에서 유일한 주소로 한정되어 있어. 어떤 조치가 필요하다. 인터넷은 공인 IP로만 연결되어 통신이 가능하다. 또한, 공인 인터넷망과 컴퓨터 사이에는 IP를 할당해주는 공유기가 있고 공유기는 공인 IP를 보유하며 인터넷과 맞닿아있다.

즉, 공유기는 사설 IP뿐인 내 컴퓨터의 IP를 공유기 자신의 공인 IP로 변환하는 것이다. → 이게 NAT 기술

## 4. 라우터의 동작 방식

스위치에서 MAC 테이블을 이용했던 것과 같이 라우터에서는 라우팅 테이블이라는 것을 이용

라우팅 테이블은 데이터를 목적지까지 보내기 위한 거리와 방법 등을 명시한 테이블로써, 데이터를 목적지로 전달하기 위해 어떤 방향으로 가야 하는지에 대한 정보를 가지고 있다.

따라서 라우터가 데이터를 목적지로 보내려고 하면 먼저 라우팅 테이블을 찾아본다.

다음과 같은 예시를 확인해보자.

![image.png](/images/2025-02/2025-02-05/04-01.png)

컴퓨터 A가 컴퓨터 B와 통신하고 싶어하는 상황이다.

1. 컴퓨터 A가 스위치 A에게 컴퓨터 B의 주소를 물어봄
2. 스위치 A는 같은 네트워크에 컴퓨터 B가 없다고 판단 후, 라우터 A에게 물어봄
3. 라우터 A는 자기가 알고 있는 일부분 인터페이스로 E1 방향으로 가서 라우터 B에게 통신
4. 라우터 B에서 컴퓨터 B까지 통신이 내려져옴